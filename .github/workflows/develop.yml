# This workflow uses actions that are not certified by GitHub.
# They are provided by a third-party and are governed by
# separate terms of service, privacy policy, and support
# documentation.

name: Develop

on:
  push:
    branches: [ "develop" ]
  pull_request:
    branches: [ "develop" ]

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
    - name: Clone repository
      uses: actions/checkout@v4

    - name: Set up JDK 11
      uses: actions/setup-java@v3
      with:
        java-version: 11
    - name: Install Android SDK and Emulator
      run: |
        # Download Android SDK tools
        wget https://dl.google.com/android/repository/commandlinetools-linux-latest.zip
        unzip commandlinetools-linux-latest.zip
        # Set up environment variables
        export PATH=$PATH:./commandlinetools/bin
        # Install Android SDK Platform for Pixel 8 (API 34)
        ./sdkmanager "platforms;android-34"
        # Install Emulator
        ./sdkmanager "emulator"
    - name: Create Pixel 8 Android Virtual Device (AVD)
      run: |
        ./emulator -avd Pixel_8_API_34_x86_64 -no-snapshot -gpu host
    - name: Set up Flutter
      uses: subosito/flutter-action@v2
      with:
        channel: stable
        flutter-version: 3.19.0
    - name: Install dependencies
      run: flutter pub get
    - name: Run unit tests
      run: flutter test
    #- name: Run integration tests
    #  run: cd example && flutter test integration_test/app_test.dart